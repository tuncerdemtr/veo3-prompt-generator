<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veo 3 Cinematic Prompt Engineer</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: #e2e8f0;
        }
        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; 
        }
        .json-key { color: #9cdcfe; }
        .json-string { color: #ce9178; }
        .json-number { color: #b5cea8; }
        .json-boolean { color: #569cd6; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // --- INLINE ICONS ---
        const Icons = {
            Film: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <rect width="18" height="18" x="3" y="3" rx="2"/><path d="M7 3v18"/><path d="M3 7.5h4"/><path d="M3 12h18"/><path d="M3 16.5h4"/><path d="M17 3v18"/><path d="M17 7.5h4"/><path d="M17 16.5h4"/>
                </svg>
            ),
            Upload: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/>
                </svg>
            ),
            Loader2: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
                </svg>
            ),
            Sparkles: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 5H5"/><path d="M19 18v4"/><path d="M15 20h4"/>
                </svg>
            ),
            AlertCircle: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/>
                </svg>
            ),
            Code: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>
                </svg>
            ),
            Copy: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>
                </svg>
            ),
            Check: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
            ),
            Plus: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M5 12h14"/><path d="M12 5v14"/>
                </svg>
            ),
            FileVideo: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="m10 11 5 3-5 3v-6z"/>
                </svg>
            ),
             ChevronRight: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    <path d="m9 18 6-6-6-6"/>
                </svg>
            ),
            MessageSquare: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                   <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                </svg>
            ),
            Monitor: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                  <rect width="20" height="14" x="2" y="3" rx="2"/><line x1="8" x2="16" y1="21" y2="21"/><line x1="12" x2="12" y1="17" y2="21"/>
                </svg>
            ),
             Smartphone: (props) => (
                <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                  <rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/>
                </svg>
            ),
        };

        const { Upload, FileVideo, Code, Plus, ChevronRight, Loader2, Sparkles, Copy, Check, AlertCircle, Film, MessageSquare, Monitor, Smartphone } = Icons;

        // --- THE PERSONA & SYSTEM PROMPT ---
        const VEO_SYSTEM_PROMPT = `
You are a Google Veo Prompt Engineer. Your sole purpose is to act as an expert assistant who converts natural language video concepts into perfectly structured, visually rich, and cinematic JSON prompts for Veo 3. You are precise, technical, and creative.

Core Task:
Analyze the provided image and/or user request.
Create a single JSON object based strictly on the structure provided below.
Fill the JSON fields with descriptive, cinematic language (Ultra-photorealistic, Film Noir, etc.).

Mandatory Rules:
1. Output Language: Descriptions in English.
2. Dialogue Language: Turkish.
3. Video Duration: 8 seconds.
4. CFG Scale: Default 7.5 (unless specified).
5. Visual Style: Ultra-photorealistic and cinematic.
6. Camera: Specific movements required.

JSON Structure (Return ONLY this JSON, no markdown code blocks):
{
  "video_generation_request": {
    "model": "google_veo_3",
    "parameters": {
      "duration_seconds": 8,
      "quality": "4k_cinematic",
      "aspect_ratio": "16:9",
      "cfg_scale": 7.5
    },
    "inputs": {
      "first_frame": {
        "file_name": "uploaded_frame.jpg",
        "description": "..."
      }
    },
    "scene_description": {
      "overall_prompt": "...",
      "sequence": [
        { "timestamp": "0s-3s", "action": "..." },
        { "timestamp": "3s-8s", "action": "..." }
      ],
      "camera_instructions": {
        "type": "...",
        "direction": "...",
        "speed": "...",
        "effect": "..."
      },
      "style_and_atmosphere": {
        "visual_style": "...",
        "lighting": "...",
        "mood": "..."
      }
    }
  }
}
`;

        const App = () => {
            const [apiKey, setApiKey] = useState('AIzaSyAyiYll-Gu2NKQ0aDxkLBjq7Cfp64U5HDo');
            const [image, setImage] = useState(null); // base64
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const [result, setResult] = useState(null);
            const [extensionMode, setExtensionMode] = useState(false);
            const [copied, setCopied] = useState(false);
            
            // New State for constraints
            const [aspectRatio, setAspectRatio] = useState("16:9");
            const [includeDialogue, setIncludeDialogue] = useState(true);

            // Mock response for demo purposes if no API key is provided
            const mockResponse = {
                "video_generation_request": {
                    "model": "google_veo_3",
                    "parameters": {
                        "duration_seconds": 8,
                        "quality": "4k_cinematic",
                        "aspect_ratio": aspectRatio,
                        "cfg_scale": 7.5
                    },
                    "inputs": {
                        "first_frame": {
                            "file_name": "demo_image.jpg",
                            "description": "Analysis requires a valid Gemini API Key. This is a placeholder structure."
                        }
                    },
                    "scene_description": {
                        "overall_prompt": "Please enter an API Key to generate a real analysis.",
                        "sequence": [],
                        "camera_instructions": {},
                        "style_and_atmosphere": {}
                    }
                }
            };

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setImage(reader.result);
                        setResult(null); // Reset previous result
                        setExtensionMode(false);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const generatePrompt = async (isExtension = false) => {
                if (!image && !isExtension) {
                    setError("Please upload an image first.");
                    return;
                }

                setLoading(true);
                setError('');

                if (!apiKey) {
                    setTimeout(() => {
                        setResult(mockResponse);
                        setLoading(false);
                        setError("Demo Mode: Enter a Gemini API Key for real analysis.");
                    }, 1500);
                    return;
                }

                try {
                    // Dynamic prompt construction based on user selections
                    const constraintInstructions = `
IMPORTANT USER CONSTRAINTS:
1. Aspect Ratio: The "aspect_ratio" parameter MUST be set to "${aspectRatio}".
2. Dialogue: ${includeDialogue ? 'Include dialogue. Dialogue MUST be in Turkish.' : 'Do NOT include any dialogue. Keep it silent or use ambient sound only.'}
`;

                    let userPrompt;
                    
                    if (isExtension && result) {
                        const previousScene = result.video_generation_request.scene_description;
                        const lastSequence = previousScene.sequence[previousScene.sequence.length - 1];
                        const lastAction = lastSequence ? lastSequence.action : "The scene ended.";
                        const previousOverall = previousScene.overall_prompt;

                        userPrompt = `
CONTINUATION TASK: You are generating Part 2 (Seconds 8-16) of a continuous video.
    
PREVIOUS CONTEXT (Part 1):
- The previous overall narrative was: "${previousOverall}"
- The scene ended with this specific action: "${lastAction}"

CRITICAL CONTINUITY INSTRUCTIONS:
1. The "first_frame" > "description" in your NEW JSON must describe the EXACT state of the scene as it ended in Part 1.
2. The new "sequence" must pick up immediately from that moment.
3. Maintain the exact same "visual_style", "lighting", and "mood" as the previous scene.

${constraintInstructions}

Generate the valid JSON for this next 8-second segment.`;
                    } else {
                        userPrompt = `Analyze this image and create a Veo 3 JSON prompt based on the persona instructions. ${constraintInstructions}`;
                    }

                    const contents = [
                        {
                            role: "user",
                            parts: [
                                { text: VEO_SYSTEM_PROMPT },
                                { text: userPrompt },
                                // Always send image for context, even in extension, to maintain character consistency
                                {
                                    inlineData: {
                                        mimeType: "image/jpeg",
                                        data: image.split(',')[1]
                                    }
                                }
                            ]
                        }
                    ];

                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: contents,
                            generationConfig: {
                                responseMimeType: "application/json"
                            }
                        })
                    });

                    const data = await response.json();

                    if (data.error) {
                        throw new Error(data.error.message);
                    }

                    const jsonText = data.candidates[0].content.parts[0].text;
                    const jsonResult = JSON.parse(jsonText);
                    
                    if (isExtension) {
                         setResult(jsonResult);
                         setExtensionMode(false); 
                    } else {
                        setResult(jsonResult);
                    }

                } catch (err) {
                    setError("API Error: " + err.message);
                } finally {
                    setLoading(false);
                }
            };

            const copyToClipboard = () => {
                const text = JSON.stringify(result, null, 2);
                
                // Fallback for iframe/permission restrictions
                const textArea = document.createElement("textarea");
                textArea.value = text;
                
                // Ensure it's not visible but part of the DOM
                textArea.style.position = "fixed";
                textArea.style.left = "-9999px";
                textArea.style.top = "0";
                document.body.appendChild(textArea);
                
                textArea.focus();
                textArea.select();
                
                try {
                    document.execCommand('copy');
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                } catch (err) {
                    console.error('Fallback: Oops, unable to copy', err);
                    setError("Failed to copy to clipboard.");
                }
                
                document.body.removeChild(textArea);
            };

            // Recursive component to render JSON nicely
            const JsonRenderer = ({ data, depth = 0 }) => {
                if (data === null) return <span className="json-null">null</span>;
                if (typeof data === 'boolean') return <span className="json-boolean">{data.toString()}</span>;
                if (typeof data === 'number') return <span className="json-number">{data}</span>;
                if (typeof data === 'string') return <span className="json-string">"{data}"</span>;

                const isArray = Array.isArray(data);
                const indent = '  '.repeat(depth);
                const bracketOpen = isArray ? '[' : '{';
                const bracketClose = isArray ? ']' : '}';

                return (
                    <span>
                        <span>{bracketOpen}</span>
                        <div style={{ paddingLeft: '20px' }}>
                            {Object.entries(data).map(([key, value], index, arr) => (
                                <div key={key}>
                                    {!isArray && <span className="json-key">"{key}": </span>}
                                    <JsonRenderer data={value} depth={depth + 1} />
                                    {index < arr.length - 1 && <span>,</span>}
                                </div>
                            ))}
                        </div>
                        <span>{indent}{bracketClose}</span>
                    </span>
                );
            };

            return (
                <div className="min-h-screen bg-slate-950 p-6 flex flex-col items-center">
                    
                    {/* Header */}
                    <div className="w-full max-w-5xl mb-8 flex items-center justify-between border-b border-slate-800 pb-6">
                        <div className="flex items-center gap-3">
                            <div className="bg-gradient-to-br from-blue-500 to-purple-600 p-2 rounded-lg">
                                <Film className="text-white w-6 h-6" />
                            </div>
                            <div>
                                <h1 className="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">
                                    Veo 3 Architect
                                </h1>
                                <p className="text-slate-400 text-sm">Cinematic Prompt Engineering Interface</p>
                            </div>
                        </div>
                        
                        {/* API Key Input */}
                        <div className="flex items-center gap-2">
                            <div className="relative group">
                                <input 
                                    type="password" 
                                    placeholder="Enter Gemini API Key" 
                                    value={apiKey}
                                    onChange={(e) => setApiKey(e.target.value)}
                                    className="bg-slate-900 border border-slate-700 rounded-md px-3 py-1.5 text-sm w-48 focus:w-64 transition-all outline-none focus:border-blue-500 text-slate-300"
                                />
                                <div className="absolute right-2 top-1.5 hidden group-hover:block">
                                    <div className="bg-slate-800 text-xs text-slate-400 px-2 py-1 rounded border border-slate-700 absolute right-0 mt-8 w-64 z-10">
                                        Required for analysis. API calls happen directly from your browser to Google.
                                    </div>
                                    <AlertCircle className="w-4 h-4 text-slate-500" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <main className="w-full max-w-5xl grid grid-cols-1 lg:grid-cols-2 gap-8">
                        
                        {/* Left Column: Inputs */}
                        <div className="space-y-6">
                            
                            {/* Upload Area */}
                            <div className={`border-2 border-dashed rounded-xl p-8 transition-all duration-300 flex flex-col items-center justify-center text-center cursor-pointer relative overflow-hidden group
                                ${image ? 'border-blue-500/50 bg-blue-900/10' : 'border-slate-700 hover:border-slate-500 hover:bg-slate-900'}`}>
                                
                                <input 
                                    type="file" 
                                    accept="image/*" 
                                    onChange={handleImageUpload}
                                    className="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"
                                />

                                {image ? (
                                    <div className="relative w-full h-64">
                                        <img src={image} alt="Preview" className="w-full h-full object-contain rounded-md" />
                                        <div className="absolute bottom-2 right-2 bg-black/70 px-2 py-1 rounded text-xs text-white">
                                            Click to replace
                                        </div>
                                    </div>
                                ) : (
                                    <div className="py-12">
                                        <div className="bg-slate-800 p-4 rounded-full inline-block mb-4 group-hover:scale-110 transition-transform">
                                            <Upload className="w-8 h-8 text-blue-400" />
                                        </div>
                                        <h3 className="text-lg font-medium text-slate-200">Upload Reference Frame</h3>
                                        <p className="text-slate-400 text-sm mt-2">Drag & drop or click to browse</p>
                                    </div>
                                )}
                            </div>

                            {/* --- CONTROLS SECTION --- */}
                            <div className="bg-slate-900 border border-slate-800 rounded-lg p-5 space-y-5">
                                <h3 className="text-sm font-semibold text-slate-300 flex items-center gap-2">
                                    <Code className="w-4 h-4" /> Generation Constraints
                                </h3>

                                {/* Aspect Ratio Selector */}
                                <div>
                                    <label className="text-xs text-slate-400 mb-2 block uppercase font-bold tracking-wider">Aspect Ratio</label>
                                    <div className="grid grid-cols-2 gap-3">
                                        <button 
                                            onClick={() => setAspectRatio("16:9")}
                                            className={`flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm transition-all border
                                                ${aspectRatio === "16:9" 
                                                    ? 'bg-blue-600/20 border-blue-500 text-blue-300' 
                                                    : 'bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700'}`}
                                        >
                                            <Monitor className="w-4 h-4" />
                                            16:9 (Landscape)
                                        </button>
                                        <button 
                                            onClick={() => setAspectRatio("9:16")}
                                            className={`flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm transition-all border
                                                ${aspectRatio === "9:16" 
                                                    ? 'bg-blue-600/20 border-blue-500 text-blue-300' 
                                                    : 'bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700'}`}
                                        >
                                            <Smartphone className="w-4 h-4" />
                                            9:16 (Portrait)
                                        </button>
                                    </div>
                                </div>

                                {/* Dialogue Toggle */}
                                <div>
                                    <label className="text-xs text-slate-400 mb-2 block uppercase font-bold tracking-wider">Dialogue</label>
                                    <div className="grid grid-cols-2 gap-3">
                                        <button 
                                            onClick={() => setIncludeDialogue(true)}
                                            className={`flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm transition-all border
                                                ${includeDialogue 
                                                    ? 'bg-green-600/20 border-green-500 text-green-300' 
                                                    : 'bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700'}`}
                                        >
                                            <MessageSquare className="w-4 h-4" />
                                            Yes (Turkish)
                                        </button>
                                        <button 
                                            onClick={() => setIncludeDialogue(false)}
                                            className={`flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm transition-all border
                                                ${!includeDialogue 
                                                    ? 'bg-red-600/20 border-red-500 text-red-300' 
                                                    : 'bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700'}`}
                                        >
                                            <span className="text-lg leading-none">&times;</span>
                                            No Dialogue
                                        </button>
                                    </div>
                                </div>
                            </div>


                            {/* Action Buttons */}
                            <div className="flex flex-col gap-4">
                                <button 
                                    onClick={() => generatePrompt(false)}
                                    disabled={loading || !image}
                                    className={`w-full py-3 px-4 rounded-lg font-semibold flex items-center justify-center gap-2 transition-all
                                        ${loading 
                                            ? 'bg-slate-800 text-slate-500 cursor-not-allowed' 
                                            : 'bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white shadow-lg shadow-blue-900/20'
                                        }`}
                                >
                                    {loading ? <Loader2 className="w-5 h-5 animate-spin" /> : <Sparkles className="w-5 h-5" />}
                                    {loading ? 'Analyzing Scene...' : 'Generate Veo Prompt'}
                                </button>

                                {error && (
                                    <div className="bg-red-900/20 border border-red-800 text-red-300 px-4 py-3 rounded-lg text-sm flex items-start gap-2">
                                        <AlertCircle className="w-5 h-5 shrink-0 mt-0.5" />
                                        <p>{error}</p>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Right Column: Output */}
                        <div className="flex flex-col h-full min-h-[500px]">
                            <div className="bg-[#1e1e1e] border border-slate-700 rounded-xl overflow-hidden shadow-2xl flex flex-col h-full">
                                
                                {/* Toolbar */}
                                <div className="bg-[#252526] px-4 py-2 border-b border-slate-700 flex items-center justify-between">
                                    <span className="text-xs font-mono text-slate-400">veo_request.json</span>
                                    
                                    <div className="flex items-center gap-2">
                                        {result && (
                                            <button 
                                                onClick={copyToClipboard}
                                                className="text-slate-400 hover:text-white transition-colors p-1.5 rounded hover:bg-slate-700"
                                                title="Copy JSON"
                                            >
                                                {copied ? <Check className="w-4 h-4 text-green-400" /> : <Copy className="w-4 h-4" />}
                                            </button>
                                        )}
                                    </div>
                                </div>

                                {/* Code Editor Area */}
                                <div className="flex-1 p-4 overflow-auto font-mono text-sm leading-relaxed">
                                    {result ? (
                                        <JsonRenderer data={result} />
                                    ) : (
                                        <div className="h-full flex flex-col items-center justify-center text-slate-600">
                                            <Code className="w-12 h-12 mb-4 opacity-20" />
                                            <p>Awaiting Image Analysis...</p>
                                        </div>
                                    )}
                                </div>

                                {/* Footer / Extend Action */}
                                {result && (
                                    <div className="p-4 bg-slate-900 border-t border-slate-800">
                                        <div className="flex items-center justify-between">
                                            <div className="text-xs text-slate-500">
                                                Satisfied with this scene?
                                            </div>
                                            <button 
                                                onClick={() => generatePrompt(true)}
                                                disabled={loading}
                                                className="bg-slate-800 hover:bg-slate-700 text-blue-400 text-xs px-3 py-2 rounded-md border border-slate-700 transition-colors flex items-center gap-2"
                                            >
                                                {loading ? <Loader2 className="w-3 h-3 animate-spin" /> : <Plus className="w-3 h-3" />}
                                                Extend Scene (Next 8s)
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
